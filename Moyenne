"""
Created on Fri Mar 15 15:37:23 2024

@author: charles
"""



import numpy as np
import matplotlib.pyplot as plt

# Fonction pour calculer la moyenne des courbes
def moyenne_courbes(courbes):
    longueur_courbes = [len(c) for c in courbes]
    if len(set(longueur_courbes)) != 1:
        raise ValueError("Toutes les courbes doivent avoir la même longueur")
    moyenne = np.mean(courbes, axis=0)
    return moyenne



# Exemple de courbes
test_curve = [-2.38741643, -2.34966036, -2.402355666666667, -2.4056285600000002, -2.4174561760000004, -2.4096658450000006, -2.4157833500000003, -2.424959221428572, -2.436986654285714, -2.420024202857143, -2.4139048742857137, -2.390685177142857, -2.374705897142857, -2.365200162857143, -2.349665607142857, -2.3474766428571425, -2.35265883, -2.3491799128571427, -2.349950342857143, -2.3553816914285712, -2.3422261071428574, -2.3091508842857142, -2.290032457142857, -2.2728279728571428, -2.245380262857143, -2.2084377428571424, -2.139353537142857, -2.0155070085714284, -1.8811847242857145, -1.694813027142857, -1.4500752528571428, -1.2443058171428572, -1.04575528, -0.8785411285714285, -0.7876541142857142, -0.7317999057142858, -0.7292119471428571, -0.7859740157142857, -0.8649417842857142, -0.9776397942857142, -1.136857607142857, -1.3467034414285715, -1.6002625914285713, -1.9198369214285715, -2.357422985714286, -2.8020351485714285, -3.3271936614285713, -3.8510400757142853, -4.416950631428571, -4.947704449999999, -5.527308881428572, -6.046008835714285, -6.550791654285715, -7.088947015714287, -7.736381654285714, -8.45244258142857, -9.352816868571429, -10.397201350000001, -11.823893720000001, -13.332412857142856, -14.851216714285714, -16.44920804, -18.097981422857142, -19.707778761428568, -21.213585034285718, -22.32070910285714, -23.317199069999997, -24.077369792857148, -25.112246502857147, -26.14644293857143, -27.229720574285714, -28.29789512428572, -29.446610130000003, -31.000528137142854, -32.93267048714286, -34.59333548285714, -36.383510192857145, -38.29322803142857, -40.34333937142857, -42.50841924857143, -44.55448014, -46.567453231428566, -48.534834028571424, -50.59458053857143, -52.48443099428572, -54.33660716428572, -56.23314610285714, -58.18912585428571, -60.19281345714286, -62.16074659000001, -63.76895508714286, -65.44768248285713, -67.00422803714285, -68.52771229, -69.86432085285715, -71.24982753142856, -72.68808279285714, -74.12358249428573, -75.55339015, -76.98759678857142, -78.33911013857143, -79.65864483571428, -80.66230983714286, -81.57481865571428, -82.43266911857143, -83.12649427428572, -83.73652695, -84.20402745857143, -84.57626692714287, -84.94675487571429, -85.2509306357143, -85.63689116714286, -86.03900202714286, -86.47530925571428, -86.88138274857143, -87.2968710514286, -87.73617403000002, -88.13928797857143, -88.47252573, -88.67812786285715, -88.80679577000001, -88.93058625000002, -88.99947964714285, -89.02788961428571, -89.05013168285713, -89.05626969142857, -89.12258669, -89.18388124714285, -89.24346629571428, -89.30941048571428, -89.37684917857143, -89.36967192857144, -89.2718190257143, -89.14276602999999, -88.98430439428572, -88.7401267, -88.40851955714285, -87.98734826142856, -87.59856190571428, -87.23151323428571, -86.79833354285715, -86.23629465, -85.71387285714286, -85.19380099857143, -84.53344813571427, -83.85181653285713, -83.09074120142857, -82.19402477428571, -81.34675341142858, -80.09301029285714, -78.73229786428571, -77.32249405714286, -75.82061265, -74.09585819428571, -72.42608508857144, -70.57444956285715, -68.71318654142857, -66.86447437428572, -65.01130681714285, -62.74695189, -60.60077915142857, -58.31127693714285, -56.027905852857145, -53.680457002857146, -50.60966493714286, -47.594164205714286, -44.75668150428571, -41.705987745714275, -38.87678959571428, -36.245615435714285, -33.70669971714286, -31.59021129285714, -29.212699905714285, -26.812686471428574, -24.449112841428576, -21.887466925714286, -19.13266092857143, -16.634562564285712, -14.334915637142856, -12.281029681428569, -10.460502617142856, -8.851066905714287, -7.412141252857144, -6.1001875014285725, -4.884390878571429, -3.916702287142857, -3.1303998399999995, -2.5011878657142854, -2.0284507042857145, -1.6544710214285714, -1.4128523528571428, -1.2291821014285715, -1.0832904757142858, -0.9910650842857143, -0.89651654, -0.8638709557142857, -0.8702888071428572, -0.8912796128571429, -0.94248936, -0.9933188457142857, -1.0435153285714285, -1.1093990414285713, -1.1395156885714286, -1.15980078, -1.1888868799999999, -1.2305731442857142, -1.2826615300000002, -1.3208989614285715, -1.3578654214285717, -1.4234181042857144, -1.4858367971428572, -1.5487574199999998, -1.5969349185714286, -1.6548637471428571, -1.7194816314285715, -1.78818536, -1.833092814285714, -1.840537212857143, -1.8249064000000002, -1.8071507014285715, -1.77408641, -1.7218989128571427, -1.6841174557142857, -1.6306141185714285, -1.6750560671428574, -1.7315780614285714, -1.799456424285714, -1.8764097728571427, -1.9647664485714285, -2.037577687142857, -2.128950664285714, -2.1452643314285713, -2.1773480899999997, -2.191438537142857, -2.1893002999999998, -2.19026684, -2.184204407142857, -2.1908620314285714, -2.1928893457142857, -2.177852312857143, -2.1788593014285715, -2.1666816357142857, -2.1506760028571428, -2.1469799785714283, -2.1076106328571425, -2.0977691928571427, -2.0617901628571427, -2.008843307142857, -1.9621789685714288, -1.9142988471428573, -1.8630061614285716, -1.8323061771428573, -1.7991616371428574, -1.7679631957142856, -1.74447826, -1.78649646, -1.8190951514285714, -1.8478247357142856, -1.864962687142857, -1.8769763714285717, -1.923372252857143, -1.979619015714286, -1.9822090042857141, -1.983654257142857, -1.9932763171428571, -1.933289742857143, -1.8762675985714288, -1.8167854899999998, -1.7686903571428572, -1.7215006942857143, -1.697412902857143, -1.6721135500000002, -1.7105832942857142, -1.7562879399999998, -1.778182567142857, -1.7870353357142859, -1.7851715257142857, -1.7776182185714284, -1.7576876457142856, -1.7099963814285712, -1.7055129528571429, -1.698903302857143, -1.6640646828571428, -1.5914510442857142, -1.5057212914285714, -1.4327857800000001, -1.405515132857143, -1.3209780885714288, -1.26466983, -1.2303009414285717, -1.198862012857143, -1.1814558714285714, -1.181654537142857, -1.1765775257142859, -1.1847880142857143, -1.183484155714286, -1.173745884285714, -1.2233546357142857, -1.256587315714286, -1.2589894057142856, -1.2692741014285713, -1.280636567142857, -1.2892971000000002, -1.3061461385714286]
max_curve = [-1.57193483, -1.49563834, -1.4802288933333332, -1.4862897425, -1.6133627059999998, -1.7221536216666664, -1.8189482457142856, -1.9381256428571427, -2.065554897142857, -2.197431837142857, -2.3966437885714287, -2.49277061, -2.5765351228571425, -2.636089595714286, -2.696806142857143, -2.7308414114285715, -2.7887802900000005, -2.7639443414285716, -2.74100929, -2.7182282042857144, -2.6682177400000002, -2.6594802642857145, -2.7623157114285712, -2.864122137142857, -3.0258083542857146, -3.30538333, -3.613548194285715, -4.006051314285714, -4.418252182857143, -4.854767077142858, -5.363074578571428, -5.890636415714285, -6.394921580000001, -6.9006399499999995, -7.536242227142858, -8.27596213, -9.081104217142856, -9.91582535142857, -10.806742861428573, -11.752122102857143, -12.703992007142856, -13.685019534285715, -14.633141714285715, -15.569056305714286, -16.471202459999997, -17.453973437142857, -18.429008327142856, -19.46244559142857, -20.424689124285717, -21.52075056714286, -22.673942724285716, -24.01346442, -25.32947571, -26.912224945714286, -28.456205935714287, -30.01522567142857, -31.864976141428574, -33.810921251428574, -35.586387192857146, -37.472455665714286, -39.24991150571429, -41.230345774285716, -43.23950662285715, -44.952372877142864, -46.55713947428571, -48.32563479714286, -50.01297625714286, -51.68462242714286, -53.34978920571428, -55.03236299285714, -56.707004157142855, -58.47831203571429, -60.18018161857143, -61.87887978571428, -63.35106902571429, -64.70607595285715, -66.08157860714286, -67.30246165857143, -68.38015455428571, -69.41582019428571, -70.57762679714286, -71.84696005714285, -73.09102189, -74.22844598857144, -75.33365811428573, -76.42350331714286, -77.4073488257143, -78.13341695428572, -78.73788980857144, -79.25296313428571, -79.67253609857143, -80.08714503285714, -80.38182187, -80.62292584714285, -80.82394126285713, -80.99316248, -81.31366782857143, -81.64836344714286, -82.04774742142857, -82.49527951142856, -83.02090892, -83.64007278, -84.39709654714287, -85.03256749285713, -85.76132176285715, -86.4300995, -87.13909876000001, -87.78985616428574, -88.32838625857144, -89.58244278, -90.78269091285713, -91.87818238428574, -92.90856041142857, -93.88166560714285, -94.84136573714285, -95.81671928142859, -96.01610964714284, -96.22229565285714, -96.42830070142858, -96.59650596142858, -96.80277945714286, -96.98055213285714, -97.19752538714285, -97.32479193571429, -97.48393221428572, -97.6371358042857, -97.85897003571428, -98.01184402285715, -98.19212208, -98.2813679857143, -98.37018136285714, -98.35124680857143, -98.29198182571427, -98.11758311999999, -97.90826794, -97.6590765257143, -97.44943905714285, -97.2569588642857, -97.09407204428571, -96.96019312857142, -96.87152323285714, -96.79369638142859, -96.66175784142855, -96.47656047857141, -96.25698106, -96.03786488, -95.80800521285717, -94.76359041285716, -93.75377700714286, -92.80913712428571, -91.9313919942857, -90.97557292285715, -90.03458069142857, -88.96527716285713, -88.68082477, -88.32914079428572, -87.94522092142857, -87.43576169142857, -86.96104655428573, -86.42039916714286, -85.92061237428571, -85.34484527571429, -84.72066471714287, -84.07065810000002, -83.49892071571428, -82.84874159285717, -82.13799085571429, -81.47328370142857, -80.83525730285714, -80.15500654142856, -79.40316549571428, -77.89235902428571, -76.44780929000001, -74.95775322999998, -73.2607142457143, -71.55201224857143, -69.62267416714285, -67.75007389428572, -66.35154622714285, -65.01135529142857, -63.74775132, -62.64579671, -61.62659250285714, -60.85893011285714, -60.03071270714286, -59.32848065000001, -58.43357417285715, -57.47007819142857, -56.31306988714285, -55.08073133, -53.31276346285714, -51.656128790000004, -50.12774365571429, -48.75677225, -47.49942771285714, -46.40882272142858, -45.28872152142857, -44.64714968, -43.99525795285714, -43.22118613142857, -42.48174418714286, -41.79868849142857, -41.19106528285714, -40.64553169714286, -40.13675575285714, -39.60687648428571, -39.07982816285715, -38.397084219999996, -37.63500516285715, -36.88602550428572, -36.06111228857143, -35.15606278571428, -34.187352118571425, -33.214649168571434, -32.26855728571429, -31.27092562428572, -30.231666948571426, -29.14695658857143, -28.203070128571426, -27.28829018142857, -26.437887205714283, -25.546519784285714, -24.680254355714286, -23.773801104285717, -22.95210445, -22.099528515714287, -21.206882387142855, -20.22793094857143, -19.309154435714284, -18.460432344285717, -17.568622961428574, -16.49474549285714, -15.449569842857143, -14.357254348571429, -13.220845875714286, -12.03661341, -10.654691745714286, -9.261559497142857, -8.056207091428572, -6.738174235714285, -5.516536397142858, -4.485082180000001, -3.5649439885714287, -2.802771062857143, -2.175422704285714, -1.6070896999999997, -1.160540782857143, -0.8108086614285716, -0.53345482, -0.38852826285714287, -0.32331716000000005, -0.29253991714285715, -0.31995853428571425, -0.4024203742857143, -0.5184677828571429, -0.6319469457142858, -0.7028271171428572, -0.82488445, -0.9415919742857143, -1.08888074, -1.2432614642857143, -1.3325920357142855, -1.405156224285714, -1.4643833585714285, -1.4995310942857143, -1.5813216071428573, -1.6477368000000001, -1.7331991285714283, -1.84374914, -1.8980332628571426, -1.9427146585714288, -1.9336360042857144, -1.891459222857143, -1.7802277228571428, -1.5984256585714287, -1.433945711428571, -1.4223753028571429, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
add=[-2.15030832, -2.3070554000000003, -2.3586484666666667, -2.38943366, -2.44767591, -2.5238576766666667, -2.5686617614285714, -2.680463672857143, -2.7642070214285717, -2.8600312928571427, -2.9250374557142855, -2.9673099757142856, -2.989967354285714, -2.99263235, -2.964503784285714, -2.9266824914285716, -2.8631132342857137, -2.7974772399999996, -2.7173834214285715, -2.6426792528571426, -2.555151145714285, -2.466823174285714, -2.3578653157142853, -2.238340574285714, -2.1325691485714287, -2.0503312085714285, -1.9225101042857144, -1.8234527514285717, -1.7175902971428574, -1.6698780485714286, -1.6750660214285715, -1.7046753185714287, -1.8301048914285716, -1.9909082328571426, -2.190743704285714, -2.582041597142857, -3.0199146514285715, -3.4885591814285717, -4.0786836314285715, -4.6824810885714285, -5.450382412857143, -6.251682785714286, -7.009307555714286, -7.713866007142857, -8.50384115142857, -9.225455148571427, -9.93484352857143, -10.578727244285714, -11.282110978571428, -12.039207351428571, -12.897615965714285, -13.78401566, -14.812376398571427, -15.880967471428571, -17.00437833142857, -18.066766089999998, -19.134339912857143, -20.23790689714286, -21.188401991428574, -22.07745274714286, -22.90939763571429, -23.67349024142857, -24.507027508571422, -25.260994385714287, -25.910072987142858, -26.61752328571429, -27.10751355857143, -27.785568318571425, -28.567500648571432, -29.36578239857143, -30.317192602857144, -31.65241864, -33.02036614714286, -34.56927853142857, -36.17655154714286, -37.67154595714286, -38.99832060714285, -40.321347384285716, -41.41009977285715, -42.47818958142857, -43.61211501000001, -44.6497008257143, -45.81847711428571, -47.16382102428572, -48.468703362857134, -49.83408912428572, -51.249459198571444, -52.616853797142866, -53.92631157428572, -55.24394607714286, -56.569271727142855, -57.79181189142857, -58.89679243285714, -60.06125077571428, -61.20953095714286, -62.21847739142857, -63.14125638428572, -63.95426110714285, -64.7933721057143, -65.60005226000001, -66.2399664, -66.96394736285716, -67.67258995428571, -68.31524125714286, -69.04419203, -69.71830776714286, -70.37817557000001, -71.09194860142858, -71.68108164285715, -72.4803189557143, -73.26002887000001, -73.94038988571428, -74.64918971714285, -75.33950376428572, -75.99616682142857, -76.62573918428572, -77.00139586571427, -77.31127896142857, -77.57444922714285, -77.71400868571429, -77.76874606714286, -77.77711805142857, -77.73736227857141, -77.70346571714286, -77.69492024571427, -77.74805734714286, -77.82491214, -77.8996539442857, -77.95665613999999, -78.03563000285715, -78.12848542714286, -78.21139450857143, -78.22522600428572, -78.2231415942857, -78.2088915457143, -78.15470408, -77.97074718142858, -77.62030880142856, -77.17089399285715, -76.67370848857142, -76.07344547142857, -75.31244454142858, -74.47224136428572, -73.61730557857143, -72.85189435000001, -72.12130788571429, -71.33263904142858, -70.54921747285714, -69.82318776571428, -69.13562764714285, -68.26838402428572, -67.35815908571429, -66.35099223428571, -65.25886302428572, -64.09375016142857, -63.069040168571426, -61.94018969857143, -60.8738991, -59.91113629428571, -58.94128729, -58.06562572142857, -57.21215948428572, -56.22094951571429, -55.174427262857144, -54.190539275714286, -53.01478846571428, -51.26230592, -49.48520015571428, -47.71841634857143, -45.855024039999996, -43.87077495, -41.88908472714286, -39.791646022857144, -37.86104054142857, -35.95158356142856, -34.12352026428571, -32.45270458857143, -30.835487852857142, -29.195196672857147, -27.77124761857143, -26.503998869999997, -25.195117577142856, -23.733355727142854, -22.097171845714286, -20.505267300000003, -18.952142322857146, -17.299827697142856, -15.956275045714287, -14.76553642, -13.630700730000001, -12.53913638857143, -11.530064754285716, -10.507431219999999, -9.379314075714285, -8.23588455, -6.965182668571428, -5.771374481428572, -4.68097564, -3.6883096471428582, -2.8720200842857144, -2.31920925, -1.9215111885714282, -1.6343239014285713, -1.417612192857143, -1.252719194285714, -1.1897567142857142, -1.1199043585714286, -1.12034698, -1.1184551585714286, -1.1282390614285716, -1.1533236014285715, -1.1961226585714289, -1.24051438, -1.2535132742857145, -1.1836534871428572, -1.0734714514285715, -0.9592028014285715, -0.85680898, -0.7590413785714285, -0.6512627057142858, -0.653372187142857, -0.6907093342857143, -0.7812551728571427, -0.9231161814285713, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]



# Liste de courbes
courbes = [test_curve, max_curve,add]

# Calcul de la moyenne
moyenne = moyenne_courbes(courbes)

# Taille de la zone d'acceptabilité (en valeur absolue)
taille_zone = 5  # Par exemple, une zone de ±0.5 autour de la moyenne

# Définition des bornes de la zone d'acceptabilité
borne_inferieure = moyenne - taille_zone
borne_superieure = moyenne + taille_zone


# Affichage
plt.figure()

# Tracer la zone d'acceptabilité
plt.fill_between(range(len(moyenne)), borne_inferieure, borne_superieure, color='green', alpha=0.5)
plt.fill_between(range(len(moyenne)), borne_inferieure, borne_superieure, color='white', alpha=0.5)
plt.plot(borne_inferieure,linestyle='--', color='gray')
plt.plot(borne_superieure, linestyle='--', color='gray')

# Tracer les courbes et la moyenne
for courbe in courbes:
    plt.plot(courbe, 'b-', alpha=0.2)  # Courbes originales en bleu clair
plt.plot(moyenne, 'g-', linewidth=2)   # Moyenne en rouge

plt.title('Moyenne de {} courbes'.format(len(courbes)))
plt.xlabel('Index')
plt.ylabel('Degres °')
plt.legend(['Zone d\'acceptabilité'])
plt.grid(True)
plt.show()
